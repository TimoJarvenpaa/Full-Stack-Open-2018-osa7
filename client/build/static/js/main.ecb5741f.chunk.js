(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{193:function(e,t,n){e.exports=n(357)},198:function(e,t,n){},357:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(56),c=n.n(l),u=(n(198),n(8)),o=n.n(u),i=n(16),s=n(17),p=n(18),m=n(21),d=n(19),f=n(22),b=n(20),h=function(e){function t(){return Object(s.a)(this,t),Object(m.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return null===this.props.notifications?null:r.a.createElement("div",{className:"notification"},this.props.notifications)}}]),t}(r.a.Component),v=Object(b.b)(function(e){return{notifications:e.notifications}},null)(h),g=n(59),E=n(58),O=n(31),y=n.n(O),j="/api/blogs",w=null,k={getAll:function(){var e=Object(i.a)(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.get(j);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),create:function(){var e=Object(i.a)(o.a.mark(function e(t){var n,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:w}},e.next=3,y.a.post(j,t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){w="bearer ".concat(e)},update:function(){var e=Object(i.a)(o.a.mark(function e(t){var n,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,e.next=3,y.a.put("".concat(j,"/").concat(n),t);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=Object(i.a)(o.a.mark(function e(t){var n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:w}},e.next=3,y.a.delete("".concat(j,"/").concat(t),n);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),comment:function(){var e=Object(i.a)(o.a.mark(function e(t,n){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.post("".concat(j,"/").concat(t,"/comments"),n);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},x=0,I=function(e,t){return function(n){var a=x++;n(function(e,t){return{type:"SET_NOTIFICATION",message:e,id:t}}(e,a)),setTimeout(function(){n(function(e){return{type:"RESET_NOTIFICATION",id:e}}(a))},1e3*t)}},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NOTIFICATION":return t.message;case"RESET_NOTIFICATION":return null;default:return e}},B={getAll:function(){var e=Object(i.a)(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.get("/api/users");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},T=function(e){return{type:"ADD_BLOG",data:e}},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_USERS":return t.data;case"ADD_BLOG":var n=e.filter(function(e){return e.id!==t.data.user._id}),a=e.find(function(e){return e.id===t.data.user._id});return Object(E.a)(n).concat([Object(g.a)({},a,{blogs:a.blogs.concat(t.data)})]);default:return e}},N=function(e){return function(){var t=Object(i.a)(o.a.mark(function t(n){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k.remove(e);case 2:n({type:"REMOVE",id:e});case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},A=function(e){return function(){var t=Object(i.a)(o.a.mark(function t(n){var a;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k.update(Object(g.a)({},e,{likes:e.likes+1}));case 2:a=t.sent,n({type:"LIKE",id:a.id}),n(I("You liked '".concat(a.title,"'"),5));case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LIKE":var n=e.filter(function(e){return e.id!==t.id}),a=e.find(function(e){return e.id===t.id});return Object(E.a)(n).concat([Object(g.a)({},a,{likes:a.likes+1})]);case"COMMENT":var r=e.filter(function(e){return e.id!==t.id}),l=e.find(function(e){return e.id===t.id});return Object(E.a)(r).concat([Object(g.a)({},l,{comments:l.comments.concat(t.data)})]);case"CREATE":return Object(E.a)(e).concat([t.data]);case"REMOVE":return e.filter(function(e){return e.id!==t.id});case"INIT_BLOGS":return t.data;default:return e}},_=n(225),D=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(m.a)(this,Object(d.a)(t).call(this,e))).toggleInfo=function(e){"DIV"===e.target.tagName&&n.setState({displayMoreInfo:!n.state.displayMoreInfo})},n.removeBlog=function(){var e=Object(i.a)(o.a.mark(function e(t){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a="Do you want to delete '".concat(t.title,"' by ").concat(t.author,"?"),n.props.user.id===t.user._id||null===t.user?window.confirm(a)&&n.props.removeBlog(t.id):window.alert("You don't have permission to remove this blog");case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n.state={displayMoreInfo:!1},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t={paddingTop:6,paddingLeft:2,paddingBottom:2,border:"solid",borderWidth:1,marginBottom:5,borderRadius:5,backgroundColor:"#ffffcc"};return this.state.displayMoreInfo?r.a.createElement("div",{onClick:this.toggleInfo,style:t,className:"fullInfo"},r.a.createElement("div",null,this.props.blog.title," by ",this.props.blog.author),r.a.createElement("a",{href:this.props.blog.url},this.props.blog.url),r.a.createElement("div",null,"has ",this.props.blog.likes,r.a.createElement("button",{onClick:function(){return e.props.likeBlog(e.props.blog)}},"like")),r.a.createElement("div",null,"added by ",this.props.blog.user.name),r.a.createElement("button",{style:{display:this.props.blog.user._id===this.props.user.id||null===this.props.blog.user?"":"none"},className:"blueButton",onClick:function(){return e.removeBlog(e.props.blog)}},"delete")):r.a.createElement("div",{onClick:this.toggleInfo,style:t,className:"defaultInfo"},r.a.createElement("div",null,r.a.createElement(_.a,{to:"/blogs/".concat(this.props.blog.id)},this.props.blog.title," by ",this.props.blog.author)))}}]),t}(r.a.Component),M={likeBlog:A,removeBlog:N},R=Object(b.b)(function(e){return{user:e.user}},M)(D),U=function(e){function t(){return Object(s.a)(this,t),Object(m.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Blogs"),this.props.blogs.sort(function(e,t){return t.likes-e.likes}).map(function(e){return r.a.createElement(R,{key:e.id,blog:e})}))}}]),t}(r.a.Component),F={likeBlog:A},G=Object(b.b)(function(e){return{blogs:e.blogs}},F)(U),V=n(370),z=function(e){function t(){return Object(s.a)(this,t),Object(m.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Users"),r.a.createElement(V.a,{striped:!0,celled:!0},r.a.createElement(V.a.Header,null,r.a.createElement(V.a.Row,null,r.a.createElement(V.a.HeaderCell,null,"Name"),r.a.createElement(V.a.HeaderCell,null,"Blogs added"))),r.a.createElement(V.a.Body,null,this.props.users.map(function(e){return r.a.createElement(V.a.Row,{key:e.id},r.a.createElement(V.a.Cell,null,r.a.createElement(_.a,{to:"/users/".concat(e.id)},e.name)),r.a.createElement(V.a.Cell,null,e.blogs.length))}))))}}]),t}(r.a.Component),J=Object(b.b)(function(e){return{users:e.users}},null)(z),H={login:function(){var e=Object(i.a)(o.a.mark(function e(t){var n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},Y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return t.data;case"LOGOUT":return null;case"SET":return t.data;default:return e}},K=n(369),W=n(371),P=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),l=0;l<a;l++)r[l]=arguments[l];return(n=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).handleSubmit=function(){var e=Object(i.a)(o.a.mark(function e(t){var a,r,l;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),a=t.target.username.value,t.target.username.value="",r=t.target.password.value,t.target.password.value="",l={username:a,password:r},n.props.login(l);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Log in to the application"),r.a.createElement(K.a,{onSubmit:this.handleSubmit},r.a.createElement(K.a.Field,null,r.a.createElement("label",null,"username:"),r.a.createElement("input",{name:"username"})),r.a.createElement(K.a.Field,null,r.a.createElement("label",null,"password:"),r.a.createElement("input",{type:"password",name:"password"})),r.a.createElement(W.a,{type:"submit"},"login")))}}]),t}(r.a.Component),q={login:function(e){return function(){var t=Object(i.a)(o.a.mark(function t(n){var a;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,H.login(e);case 3:a=t.sent,k.setToken(a.token),window.localStorage.setItem("loggedBlogAppUser",JSON.stringify(a)),n({type:"LOGIN",data:a}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),n(I("invalid username or password",5));case 12:case"end":return t.stop()}},t,this,[[0,9]])}));return function(e){return t.apply(this,arguments)}}()}},Q=Object(b.b)(null,q)(P),X=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),l=0;l<a;l++)r[l]=arguments[l];return(n=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).handleSubmit=function(){var e=Object(i.a)(o.a.mark(function e(t){var a,r,l,c;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),a=t.target.title.value,t.target.title.value="",r=t.target.author.value,t.target.author.value="",l=t.target.url.value,t.target.url.value="",c={title:a,author:r,url:l},n.props.createBlog(c);case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Create new"),r.a.createElement(K.a,{onSubmit:this.handleSubmit},r.a.createElement(K.a.Field,null,r.a.createElement("label",null,"title:"),r.a.createElement("input",{type:"text",name:"title"})),r.a.createElement(K.a.Field,null,r.a.createElement("label",null,"author:"),r.a.createElement("input",{type:"text",name:"author"})),r.a.createElement(K.a.Field,null,r.a.createElement("label",null,"url:"),r.a.createElement("input",{type:"text",name:"url"})),r.a.createElement(W.a,{type:"submit"},"create")))}}]),t}(r.a.Component),Z={createBlog:function(e){return function(){var t=Object(i.a)(o.a.mark(function t(n){var a;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k.create(e);case 2:a=t.sent,n({type:"CREATE",data:a}),n(T(a)),n(I("a new blog '".concat(a.title,"' by ").concat(a.author," added"),5));case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}},$=Object(b.b)(null,Z)(X),ee=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(m.a)(this,Object(d.a)(t).call(this,e))).toggleVisibility=function(){n.setState({visible:!n.state.visible})},n.state={visible:!1},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e={display:this.state.visible?"none":""},t={display:this.state.visible?"":"none"};return r.a.createElement("div",null,r.a.createElement("div",{style:e},r.a.createElement(W.a,{onClick:this.toggleVisibility},this.props.buttonLabel)),r.a.createElement("div",{style:t},this.props.children,r.a.createElement(W.a,{onClick:this.toggleVisibility},"cancel")))}}]),t}(r.a.Component),te=function(e){var t=e.user;return r.a.createElement("div",null,r.a.createElement("h2",null,t.name),r.a.createElement("h3",null,"Added blogs"),r.a.createElement("ul",null,t.blogs.map(function(e){return r.a.createElement("li",{key:e._id},e.title," by ",e.author)})))},ne=n(367),ae=n(373),re=n(359),le=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),l=0;l<a;l++)r[l]=arguments[l];return(n=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).handleSubmit=function(){var e=Object(i.a)(o.a.mark(function e(t){var a,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),a=t.target.comment.value,t.target.comment.value="",r={comment:a},n.props.addComment(n.props.blog.id,r);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(K.a,{onSubmit:this.handleSubmit},r.a.createElement(K.a.Field,null,r.a.createElement("input",{name:"comment"})),r.a.createElement(W.a,{type:"submit"},"add comment")))}}]),t}(r.a.Component),ce={addComment:function(e,t){return function(){var n=Object(i.a)(o.a.mark(function n(a){return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,k.comment(e,t);case 2:a({type:"COMMENT",id:e,data:t}),a(I("comment '".concat(t.comment,"'"),5));case 4:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}()}},ue=Object(b.b)(null,ce)(le),oe=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),l=0;l<a;l++)r[l]=arguments[l];return(n=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).removeBlog=function(){var e=Object(i.a)(o.a.mark(function e(t){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a="Do you want to delete '".concat(t.title,"' by ").concat(t.author,"?"),n.props.user.id===t.user._id||null===t.user?window.confirm(a)&&(n.props.removeBlog(t.id),n.props.history.push("/")):window.alert("You don't have permission to remove this blog");case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("h2",null,this.props.blog.title," by ",this.props.blog.author),r.a.createElement("a",{href:this.props.blog.url},this.props.blog.url),r.a.createElement("div",null,this.props.blog.likes," likes",r.a.createElement("button",{onClick:function(){return e.props.likeBlog(e.props.blog)}},"like")),r.a.createElement("div",null,"added by ",this.props.blog.user.name),r.a.createElement("button",{style:{display:this.props.blog.user._id===this.props.user.id||null===this.props.blog.user?"":"none"},className:"blueButton",onClick:function(){return e.removeBlog(e.props.blog)}},"delete"),r.a.createElement("h3",null,"comments"),r.a.createElement(ue,{blog:this.props.blog}),r.a.createElement("ul",null,this.props.blog.comments.map(function(e){return r.a.createElement("li",{key:e.comment},e.comment)})))}}]),t}(r.a.Component),ie={likeBlog:A,removeBlog:N},se=Object(b.b)(function(e){return{user:e.user}},ie)(oe),pe=n(368),me=n(372),de=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(m.a)(this,Object(d.a)(t).call(this,e))).componentDidMount=Object(i.a)(o.a.mark(function e(){var t,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.props.initializeBlogs(),n.props.initializeUsers()]);case 2:(t=window.localStorage.getItem("loggedBlogAppUser"))&&(a=JSON.parse(t),n.props.setUser(a));case 4:case"end":return e.stop()}},e,this)})),n.state={loginVisible:!1},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Blog list application"),r.a.createElement(me.a,{inverted:!0},r.a.createElement(me.a.Item,{link:!0},r.a.createElement(ne.a,{exact:!0,to:"/"},"blogs")),r.a.createElement(me.a.Item,{link:!0},r.a.createElement(ne.a,{exact:!0,to:"/users"},"users")),r.a.createElement(me.a.Item,null,e.props.user?r.a.createElement("span",null,r.a.createElement("em",null,e.props.user.name," is logged in")," \xa0",r.a.createElement(W.a,{onClick:function(){return e.props.logout()}},"logout")):r.a.createElement(ne.a,{to:"/login"},"login"))))},n=function(){return r.a.createElement(pe.a,null,r.a.createElement(t,null),r.a.createElement(v,null),r.a.createElement(ee,{buttonLabel:"create new"},r.a.createElement($,null)),r.a.createElement(G,null))},a=function(){return r.a.createElement(pe.a,null,r.a.createElement(t,null),r.a.createElement(v,null),r.a.createElement(ee,{buttonLabel:"create new"},r.a.createElement($,null)),r.a.createElement(J,null))},l=function(e){var n=e.match;return r.a.createElement(pe.a,null,r.a.createElement(t,null),r.a.createElement(v,null),r.a.createElement(ee,{buttonLabel:"create new"},r.a.createElement($,null)),r.a.createElement(te,{user:c(n.params.id)}))},c=function(t){return e.props.users.find(function(e){return e.id===t})},u=function(e){var n=e.match,a=e.history;return r.a.createElement(pe.a,null,r.a.createElement(t,null),r.a.createElement(v,null),r.a.createElement(ee,{buttonLabel:"create new"},r.a.createElement($,null)),r.a.createElement(se,{blog:o(n.params.id),history:a}))},o=function(t){return e.props.blogs.find(function(e){return e.id===t})};return null===this.props.user?r.a.createElement(pe.a,null,r.a.createElement(v,null),r.a.createElement(ee,{buttonLabel:"sign in"},r.a.createElement(Q,null))):r.a.createElement(pe.a,null,r.a.createElement(ae.a,null,r.a.createElement("div",null,r.a.createElement(re.a,{exact:!0,path:"/",render:function(){return r.a.createElement(n,null)}}),r.a.createElement(re.a,{exact:!0,path:"/users",render:function(){return r.a.createElement(a,null)}}),r.a.createElement(re.a,{exact:!0,path:"/users/:id",render:function(e){var t=e.match;return r.a.createElement(l,{match:t})}}),r.a.createElement(re.a,{exact:!0,path:"/blogs/:id",render:function(e){var t=e.match,n=e.history;return r.a.createElement(u,{match:t,history:n})}}))))}}]),t}(r.a.Component),fe={initializeBlogs:function(){return function(){var e=Object(i.a)(o.a.mark(function e(t){var n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},initializeUsers:function(){return function(){var e=Object(i.a)(o.a.mark(function e(t){var n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.getAll();case 2:n=e.sent,t({type:"INIT_USERS",data:n});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},setUser:function(e){return{type:"SET",data:e}},logout:function(){return window.localStorage.removeItem("loggedBlogAppUser"),k.setToken(null),{type:"LOGOUT"}}},be=Object(b.b)(function(e){return{user:e.user,users:e.users,blogs:e.blogs}},fe)(de),he=n(44),ve=n(181),ge=n(182),Ee=Object(he.combineReducers)({notifications:C,blogs:L,user:Y,users:S}),Oe=Object(he.createStore)(Ee,Object(ge.composeWithDevTools)(Object(he.applyMiddleware)(ve.a)));c.a.render(r.a.createElement(b.a,{store:Oe},r.a.createElement(be,null)),document.getElementById("root"))}},[[193,2,1]]]);
//# sourceMappingURL=main.ecb5741f.chunk.js.map