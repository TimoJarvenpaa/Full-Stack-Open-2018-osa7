(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{14:function(e,t,n){},30:function(e,t,n){e.exports=n(62)},62:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(24),s=n.n(o),i=(n(14),n(25)),l=n(1),u=n.n(l),c=n(2),p=n(5),h=n(6),d=n(9),b=n(7),m=n(10),g=n(8),f=function(e){function t(){return Object(p.a)(this,t),Object(d.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props.notifications;return null===e?null:r.a.createElement("div",{className:"notification"},e)}}]),t}(r.a.Component),v=Object(g.b)(function(e){return{notifications:e.notifications}},null)(f),w=0,E=function(e,t){return function(n){var a=w++;n(function(e,t){return{type:"SET_NOTIFICATION",message:e,id:t}}(e,a)),setTimeout(function(){n(function(e){return{type:"RESET_NOTIFICATION",id:e}}(a))},1e3*t)}},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NOTIFICATION":return t.message;case"RESET_NOTIFICATION":return null;default:return e}},O=n(12),k=n.n(O),j=null,x={getAll:function(){var e=Object(c.a)(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.a.get("/api/blogs");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),create:function(){var e=Object(c.a)(u.a.mark(function e(t){var n,a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:j}},e.next=3,k.a.post("/api/blogs",t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){j="bearer ".concat(e)},update:function(){var e=Object(c.a)(u.a.mark(function e(t){var n,a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,e.next=3,k.a.put("".concat("/api/blogs","/").concat(n),t);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=Object(c.a)(u.a.mark(function e(t){var n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:j}},e.next=3,k.a.delete("".concat("/api/blogs","/").concat(t),n);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},C=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(d.a)(this,Object(b.a)(t).call(this,e))).toggleInfo=function(e){"DIV"===e.target.tagName&&n.setState({displayMoreInfo:!n.state.displayMoreInfo})},n.likeBlog=Object(c.a)(u.a.mark(function e(){var t,a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={id:n.props.blog.id,title:n.props.blog.title,author:n.props.blog.author,url:n.props.blog.url,likes:n.props.blog.likes+1,user:n.props.blog.user._id},e.next=3,x.update(t);case 3:a=e.sent,n.props.updateBlogs(a);case 5:case"end":return e.stop()}},e,this)})),n.removeBlog=Object(c.a)(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t="Do you want to delete '".concat(n.props.blog.title,"' by ").concat(n.props.blog.author,"?"),n.props.user.id!==n.props.blog.user._id&&null!==n.props.blog.user){e.next=14;break}if(!window.confirm(t)){e.next=12;break}return e.prev=3,e.next=6,x.remove(n.props.blog.id.toString());case 6:n.props.removeFromBlogs(n.props.blog),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),console.log(e.t0);case 12:e.next=15;break;case 14:window.alert("You don't have permission to remove this blog");case 15:case"end":return e.stop()}},e,this,[[3,9]])})),n.state={displayMoreInfo:!1},n}return Object(m.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e={paddingTop:6,paddingLeft:2,paddingBottom:2,border:"solid",borderWidth:1,marginBottom:5},t={display:this.props.blog.user._id===this.props.user.id||null===this.props.blog.user?"":"none"};return this.state.displayMoreInfo?r.a.createElement("div",{onClick:this.toggleInfo,style:e,className:"fullInfo"},r.a.createElement("div",null,this.props.blog.title," by ",this.props.blog.author),r.a.createElement("a",{href:this.props.blog.url},this.props.blog.url),r.a.createElement("div",null,this.props.blog.likes," likes",r.a.createElement("button",{onClick:this.likeBlog},"like")),r.a.createElement("div",null,"added by ",this.props.blog.user.name),r.a.createElement("button",{style:t,className:"blueButton",onClick:this.removeBlog},"delete")):r.a.createElement("div",{onClick:this.toggleInfo,style:e,className:"defaultInfo"},this.props.blog.title," ",this.props.blog.author)}}]),t}(r.a.Component),S={notify:E},I=Object(g.b)(null,S)(C),B=function(e){var t=e.handleSubmit,n=e.handleChange,a=e.username,o=e.password;return r.a.createElement("div",null,r.a.createElement("h2",null,"Log in to the application"),r.a.createElement("form",{onSubmit:t},r.a.createElement("div",null,"username:",r.a.createElement("input",{name:"username",value:a,onChange:n})),r.a.createElement("div",null,"password:",r.a.createElement("input",{type:"password",name:"password",value:o,onChange:n})),r.a.createElement("button",{type:"submit"},"login")))},T=function(e){var t=e.handleSubmit,n=e.handleChange,a=e.title,o=e.author,s=e.url;return r.a.createElement("div",null,r.a.createElement("h2",null,"Create new"),r.a.createElement("form",{onSubmit:t},r.a.createElement("div",null,"title:",r.a.createElement("input",{type:"text",name:"title",value:a,onChange:n})),r.a.createElement("div",null,"author:",r.a.createElement("input",{type:"text",name:"author",value:o,onChange:n})),r.a.createElement("div",null,"url:",r.a.createElement("input",{type:"text",name:"url",value:s,onChange:n})),r.a.createElement("button",{type:"submit"},"create")))},N=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(d.a)(this,Object(b.a)(t).call(this,e))).toggleVisibility=function(){n.setState({visible:!n.state.visible})},n.state={visible:!1},n}return Object(m.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e={display:this.state.visible?"none":""},t={display:this.state.visible?"":"none"};return r.a.createElement("div",null,r.a.createElement("div",{style:e},r.a.createElement("button",{onClick:this.toggleVisibility},this.props.buttonLabel)),r.a.createElement("div",{style:t},this.props.children,r.a.createElement("button",{onClick:this.toggleVisibility},"cancel")))}}]),t}(r.a.Component),A={login:function(){var e=Object(c.a)(u.a.mark(function e(t){var n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},F=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(d.a)(this,Object(b.a)(t).call(this,e))).componentDidMount=Object(c.a)(u.a.mark(function e(){var t,a,r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.getAll();case 2:t=e.sent,n.setState({blogs:t.sort(n.compareLikes)}),(a=window.localStorage.getItem("loggedBlogAppUser"))&&(r=JSON.parse(a),n.setState({user:r}));case 6:case"end":return e.stop()}},e,this)})),n.handleFieldChange=function(e){n.setState(Object(i.a)({},e.target.name,e.target.value))},n.login=function(){var e=Object(c.a)(u.a.mark(function e(t){var a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,A.login({username:n.state.username,password:n.state.password});case 4:a=e.sent,x.setToken(a.token),window.localStorage.setItem("loggedBlogAppUser",JSON.stringify(a)),n.setState({username:"",password:"",user:a}),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(1);case 12:case"end":return e.stop()}},e,this,[[1,10]])}));return function(t){return e.apply(this,arguments)}}(),n.logout=function(){window.localStorage.removeItem("loggedBlogAppUser"),x.setToken(null),n.setState({user:null,title:"",author:"",url:""})},n.addBlog=function(){var e=Object(c.a)(u.a.mark(function e(t){var a,r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a={title:n.state.title,author:n.state.author,url:n.state.url},e.next=4,x.create(a);case 4:r=e.sent,n.setState({blogs:n.state.blogs.concat(r).sort(n.compareLikes),title:"",author:"",url:""}),n.props.notify("a new blog '".concat(r.title,"' by ").concat(r.author," added"));case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n.updateBlogs=function(){var e=Object(c.a)(u.a.mark(function e(t){var a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.state.blogs.map(function(e){return e.id===t.id?t:e}),e.next=3,n.setState({blogs:a.sort(n.compareLikes)});case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n.compareLikes=function(e,t){return t.likes-e.likes},n.removeFromBlogs=function(){var e=Object(c.a)(u.a.mark(function e(t){var a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.state.blogs.filter(function(e){return e.id!==t.id}),e.next=3,n.setState({blogs:a.sort(n.compareLikes)});case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n.state={blogs:[],username:"",password:"",user:null,title:"",author:"",url:"",loginVisible:!1},n}return Object(m.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this;return null===this.state.user?r.a.createElement("div",null,r.a.createElement(v,null),r.a.createElement(N,{buttonLabel:"sign in"},r.a.createElement(B,{username:this.state.username,password:this.state.password,handleChange:this.handleFieldChange,handleSubmit:this.login}))):r.a.createElement("div",null,r.a.createElement(v,null),r.a.createElement("h2",null,"blogs"),r.a.createElement("p",null,this.state.user.name," is currently logged in "),r.a.createElement("button",{onClick:this.logout},"logout"),r.a.createElement(T,{title:this.state.title,author:this.state.author,url:this.state.url,handleChange:this.handleFieldChange,handleSubmit:this.addBlog}),this.state.blogs.map(function(t){return r.a.createElement(I,{key:t.id,blog:t,user:e.state.user,updateBlogs:e.updateBlogs,removeFromBlogs:e.removeFromBlogs})}))}}]),t}(r.a.Component),L={notify:E},_=Object(g.b)(null,L)(F),D=n(11),M=n(28),V=n(29),J=Object(D.combineReducers)({notifications:y}),R=Object(D.createStore)(J,Object(V.composeWithDevTools)(Object(D.applyMiddleware)(M.a)));s.a.render(r.a.createElement(g.a,{store:R},r.a.createElement(_,null)),document.getElementById("root"))}},[[30,2,1]]]);
//# sourceMappingURL=main.a83508e8.chunk.js.map